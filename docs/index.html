<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pablo Vivas">
<meta name="dcterms.date" content="2023-12-19">

<title>exam-02-epsy-8265 - Exam-02</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">exam-02-epsy-8265</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page"><i class="bi bi-file-earmark-check" role="img">
</i> 
 <span class="menu-text">Answers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./assets/exam-02.pdf" rel="" target=""><i class="bi bi-file-earmark" role="img">
</i> 
 <span class="menu-text">Questions</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
    <a href="https://github.com/vivas014/exam-02" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#question-1" id="toc-question-1" class="nav-link active" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="exam-02-pablo-vivas.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exam-02</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pablo Vivas </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 19, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="question-1" class="level1">
<h1>Question 1</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"./data/personality-1.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data_sub <span class="ot">=</span> data <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">str_c</span>(<span class="st">"pers"</span>, <span class="fu">c</span>(<span class="st">"03"</span>, <span class="st">"07"</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">26</span>, <span class="dv">36</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="a" class="level2">
<h2 class="anchored" data-anchor-id="a">a)</h2>
<p>The single-factor model using seven indicators is statistically identified. This because the model contains <span class="math inline">\(14\)</span> parameters <span class="math inline">\((\lambda_1,...,\lambda_7, \varepsilon_1, ..., \varepsilon_7)\)</span> and the correlation matrix contains <span class="math inline">\(\frac{7(7+1)}{2} = \frac{56}{2} = 28\)</span> unique pieces of information, also known as degrees of freedom. Hence, we have more degrees of freedom than model parameters which results in the model being statistically identified. (We have <span class="math inline">\(28-14 = 14\)</span> degrees of freedom to spare ðŸ¥³)</p>
</section>
<section id="b" class="level2">
<h2 class="anchored" data-anchor-id="b">b)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mod_01 <span class="ot">=</span> <span class="st">'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="st">  f1 =~ pers03 + pers07 + pers11 + pers13 + pers16 + pers26 + pers36</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>cfa_01 <span class="ot">=</span> <span class="fu">cfa</span>(mod_01, <span class="at">data =</span> data_sub)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(cfa_01) <span class="sc">|&gt;</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> names,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">round</span>(x, <span class="dv">2</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.keep =</span> <span class="st">"unused"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"cfi"</span>, <span class="st">"tli"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">~</span>  <span class="fu">px</span>(<span class="dv">100</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-fit-one-factor-cfa" class="anchored">

<div id="eorchqysbe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eorchqysbe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eorchqysbe thead, #eorchqysbe tbody, #eorchqysbe tfoot, #eorchqysbe tr, #eorchqysbe td, #eorchqysbe th {
  border-style: none;
}

#eorchqysbe p {
  margin: 0;
  padding: 0;
}

#eorchqysbe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eorchqysbe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eorchqysbe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eorchqysbe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eorchqysbe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eorchqysbe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eorchqysbe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eorchqysbe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eorchqysbe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eorchqysbe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eorchqysbe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eorchqysbe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eorchqysbe .gt_spanner_row {
  border-bottom-style: hidden;
}

#eorchqysbe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eorchqysbe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eorchqysbe .gt_from_md > :first-child {
  margin-top: 0;
}

#eorchqysbe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eorchqysbe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eorchqysbe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eorchqysbe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eorchqysbe .gt_row_group_first td {
  border-top-width: 2px;
}

#eorchqysbe .gt_row_group_first th {
  border-top-width: 2px;
}

#eorchqysbe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eorchqysbe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eorchqysbe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eorchqysbe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eorchqysbe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eorchqysbe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eorchqysbe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eorchqysbe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eorchqysbe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eorchqysbe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eorchqysbe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eorchqysbe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eorchqysbe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eorchqysbe .gt_left {
  text-align: left;
}

#eorchqysbe .gt_center {
  text-align: center;
}

#eorchqysbe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eorchqysbe .gt_font_normal {
  font-weight: normal;
}

#eorchqysbe .gt_font_bold {
  font-weight: bold;
}

#eorchqysbe .gt_font_italic {
  font-style: italic;
}

#eorchqysbe .gt_super {
  font-size: 65%;
}

#eorchqysbe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eorchqysbe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eorchqysbe .gt_indent_1 {
  text-indent: 5px;
}

#eorchqysbe .gt_indent_2 {
  text-indent: 10px;
}

#eorchqysbe .gt_indent_3 {
  text-indent: 15px;
}

#eorchqysbe .gt_indent_4 {
  text-indent: 20px;
}

#eorchqysbe .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" style="table-layout: fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;1:  <p>Fit measures for one-factor model</p> </caption>
  <colgroup>
    <col>
    <col style="width:100px;">
  </colgroup>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="measure">measure</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="value">value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="measure" class="gt_row gt_left">chisq</td>
<td headers="value" class="gt_row gt_center">335.48</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">pvalue</td>
<td headers="value" class="gt_row gt_center">0.00</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">cfi</td>
<td headers="value" class="gt_row gt_center">0.46</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">tli</td>
<td headers="value" class="gt_row gt_center">0.19</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">rmsea</td>
<td headers="value" class="gt_row gt_center">0.23</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">srmr</td>
<td headers="value" class="gt_row gt_center">0.17</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>Given the results of <a href="#tbl-fit-one-factor-cfa">Table&nbsp;1</a>, the model doesnâ€™t seem to fit the data. Hence, no interpretation of the parameter estimates is needed.</p>
</section>
<section id="c" class="level2">
<h2 class="anchored" data-anchor-id="c">c)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(cfa_01, <span class="at">type =</span> <span class="st">"standardized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "standardized"

$cov
       pers03 pers07 pers11 pers13 pers16 pers26 pers36
pers03  0.000                                          
pers07 -1.273  0.000                                   
pers11 -1.573 -1.031  0.000                            
pers13  4.594  1.889 -3.704  0.000                     
pers16 -1.317  0.380  7.996 -5.858  0.000              
pers26 -0.538 -2.414  6.839 -4.201  8.375  0.000       
pers36 -3.965  0.214  5.930 -1.999  7.634  7.289  0.000</code></pre>
</div>
</div>
<p>We see huge standardized residuals, specifically in the correlation estimates of <code>pers36</code> and the other items. This is probably due to the wording of this question and its relationship to the other items (they may be correlated). Also, the biggest misfit is happening in the estimate for the correlation between <code>per26</code> and <code>per16</code>, more than 8 units off. However, it is unclear why is this happening with this two items that seem somewhat different (<code>per16</code>:generates enthusiasm in others, <code>per26</code>: assertive).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(cfa_01, <span class="at">sort =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      lhs op    rhs     mi    epc sepc.lv sepc.all sepc.nox
34 pers16 ~~ pers26 86.315  0.505   0.505    0.449    0.449
28 pers11 ~~ pers16 76.881  0.485   0.485    0.423    0.423
35 pers16 ~~ pers36 69.905  0.452   0.452    0.406    0.406
36 pers26 ~~ pers36 62.433  0.498   0.498    0.383    0.383
29 pers11 ~~ pers26 53.372  0.471   0.471    0.352    0.352
18 pers03 ~~ pers13 49.437  0.833   0.833    1.708    1.708
30 pers11 ~~ pers36 39.064  0.401   0.401    0.302    0.302
31 pers13 ~~ pers16 28.195 -0.247  -0.247   -0.358   -0.358
32 pers13 ~~ pers26 15.656 -0.212  -0.212   -0.263   -0.263
21 pers03 ~~ pers36 13.363 -0.182  -0.182   -0.231   -0.231
27 pers11 ~~ pers13 12.387 -0.190  -0.190   -0.232   -0.232
23 pers07 ~~ pers13  6.781  0.184   0.184    0.310    0.310
25 pers07 ~~ pers26  5.680 -0.119  -0.119   -0.123   -0.123
33 pers13 ~~ pers36  3.471 -0.101  -0.101   -0.127   -0.127
16 pers03 ~~ pers07  2.661 -0.102  -0.102   -0.174   -0.174
17 pers03 ~~ pers11  2.288 -0.075  -0.075   -0.093   -0.093
19 pers03 ~~ pers16  1.514 -0.052  -0.052   -0.077   -0.077
22 pers07 ~~ pers11  1.046 -0.052  -0.052   -0.053   -0.053
20 pers03 ~~ pers26  0.271 -0.026  -0.026   -0.032   -0.032
24 pers07 ~~ pers16  0.143  0.016   0.016    0.020    0.020
26 pers07 ~~ pers36  0.046  0.011   0.011    0.011    0.011</code></pre>
</div>
</div>
<p>As suspected, adding some correlation terms between the error component of the items will improve the fit in the model. This makes sense as some of the items are very similar and probably is easy to understand within the personality theories. Given that we have only <span class="math inline">\(14\)</span> degrees of freedom left, I will add <span class="math inline">\(10\)</span> correlation terms as specified in the table above. This because I am interested in maintaining an over-identified model while still be able to asses the fit of it.</p>
</section>
<section id="d" class="level2">
<h2 class="anchored" data-anchor-id="d">d)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mod_02 <span class="ot">=</span> <span class="st">'</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="st">  f1 =~ pers03 + pers07 + pers11 + pers13 + pers16 + pers26 + pers36</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">  pers16    ~~  pers26</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="st">  pers11    ~~  pers16</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="st">  pers16    ~~  pers36</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="st">  pers26    ~~  pers36</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="st">  pers11    ~~  pers26</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="st">  pers03    ~~  pers13</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="st">  pers11    ~~  pers36</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="st">  pers13    ~~  pers16</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="st">  pers13    ~~  pers26</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="st">  pers03    ~~  pers36</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>cfa_02 <span class="ot">=</span> <span class="fu">cfa</span>(mod_02, <span class="at">data =</span> data_sub)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(cfa_02) <span class="sc">|&gt;</span> </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure =</span> names,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">round</span>(x, <span class="dv">2</span>),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">.keep =</span> <span class="st">"unused"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"cfi"</span>, <span class="st">"tli"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">~</span>  <span class="fu">px</span>(<span class="dv">100</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-fit-one-factor-cfa-corr" class="anchored">

<div id="gmoqdicmun" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gmoqdicmun table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gmoqdicmun thead, #gmoqdicmun tbody, #gmoqdicmun tfoot, #gmoqdicmun tr, #gmoqdicmun td, #gmoqdicmun th {
  border-style: none;
}

#gmoqdicmun p {
  margin: 0;
  padding: 0;
}

#gmoqdicmun .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gmoqdicmun .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gmoqdicmun .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gmoqdicmun .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gmoqdicmun .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gmoqdicmun .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gmoqdicmun .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gmoqdicmun .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gmoqdicmun .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gmoqdicmun .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gmoqdicmun .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gmoqdicmun .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gmoqdicmun .gt_spanner_row {
  border-bottom-style: hidden;
}

#gmoqdicmun .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gmoqdicmun .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gmoqdicmun .gt_from_md > :first-child {
  margin-top: 0;
}

#gmoqdicmun .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gmoqdicmun .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gmoqdicmun .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gmoqdicmun .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gmoqdicmun .gt_row_group_first td {
  border-top-width: 2px;
}

#gmoqdicmun .gt_row_group_first th {
  border-top-width: 2px;
}

#gmoqdicmun .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gmoqdicmun .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gmoqdicmun .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gmoqdicmun .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gmoqdicmun .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gmoqdicmun .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gmoqdicmun .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gmoqdicmun .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gmoqdicmun .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gmoqdicmun .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gmoqdicmun .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gmoqdicmun .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gmoqdicmun .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gmoqdicmun .gt_left {
  text-align: left;
}

#gmoqdicmun .gt_center {
  text-align: center;
}

#gmoqdicmun .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gmoqdicmun .gt_font_normal {
  font-weight: normal;
}

#gmoqdicmun .gt_font_bold {
  font-weight: bold;
}

#gmoqdicmun .gt_font_italic {
  font-style: italic;
}

#gmoqdicmun .gt_super {
  font-size: 65%;
}

#gmoqdicmun .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gmoqdicmun .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gmoqdicmun .gt_indent_1 {
  text-indent: 5px;
}

#gmoqdicmun .gt_indent_2 {
  text-indent: 10px;
}

#gmoqdicmun .gt_indent_3 {
  text-indent: 15px;
}

#gmoqdicmun .gt_indent_4 {
  text-indent: 20px;
}

#gmoqdicmun .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" style="table-layout: fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;2:  <p>Fit measures for one-factor model with correlated errors</p> </caption>
  <colgroup>
    <col>
    <col style="width:100px;">
  </colgroup>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="measure">measure</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="value">value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="measure" class="gt_row gt_left">chisq</td>
<td headers="value" class="gt_row gt_center">5.92</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">pvalue</td>
<td headers="value" class="gt_row gt_center">0.21</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">cfi</td>
<td headers="value" class="gt_row gt_center">1.00</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">tli</td>
<td headers="value" class="gt_row gt_center">0.98</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">rmsea</td>
<td headers="value" class="gt_row gt_center">0.03</td></tr>
    <tr><td headers="measure" class="gt_row gt_left">srmr</td>
<td headers="value" class="gt_row gt_center">0.02</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>Given the results of <a href="#tbl-fit-one-factor-cfa-corr">Table&nbsp;2</a>, we can claim that the data does fit the specified one-factor model with some correlated errors. Comparing this table with the results of <a href="#tbl-fit-one-factor-cfa">Table&nbsp;1</a>, it is clear the improvement of the original model fitted originally. Also, it is worth mentioning that these two models are nested (the model with no correlation terms is nested into the model with correlation error terms). Because of this fact, we can compare the fit of this two nested models through a <span class="math inline">\(\chi^2\)</span> test.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(cfa_01, cfa_02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

       Df    AIC    BIC    Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)    
cfa_02  4 8607.8 8705.8   5.9217                                          
cfa_01 14 8917.3 8974.5 335.4780     329.56 0.26949      10  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The results on this test point out what we found with the goodness of fit indexes: the second model does a better job in describing the relationship between the 7 items we analyzed. From a information-based criteria, the second model also has smaller values of AIC and BIC.</p>
</section>
<section id="e" class="level2">
<h2 class="anchored" data-anchor-id="e">e)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cfa_02, <span class="at">standardized=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 46 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        24

                                                  Used       Total
  Number of observations                           440         452

Model Test User Model:
                                                      
  Test statistic                                 5.922
  Degrees of freedom                                 4
  P-value (Chi-square)                           0.205

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  f1 =~                                                                 
    pers03            1.000                               0.505    0.515
    pers07            1.296    0.458    2.831    0.005    0.654    0.666
    pers11            0.160    0.147    1.089    0.276    0.081    0.068
    pers13            1.274    0.153    8.313    0.000    0.643    0.613
    pers16            0.374    0.142    2.627    0.009    0.189    0.189
    pers26            0.150    0.152    0.990    0.322    0.076    0.065
    pers36            0.469    0.170    2.762    0.006    0.237    0.203

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .pers16 ~~                                                             
   .pers26            0.518    0.061    8.495    0.000    0.518    0.453
 .pers11 ~~                                                             
   .pers16            0.491    0.061    8.029    0.000    0.491    0.424
 .pers16 ~~                                                             
   .pers36            0.446    0.061    7.321    0.000    0.446    0.397
 .pers26 ~~                                                             
   .pers36            0.528    0.070    7.550    0.000    0.528    0.397
 .pers11 ~~                                                             
   .pers26            0.492    0.070    7.054    0.000    0.492    0.359
 .pers03 ~~                                                             
   .pers13            0.247    0.120    2.058    0.040    0.247    0.355
 .pers11 ~~                                                             
   .pers36            0.423    0.069    6.159    0.000    0.423    0.313
 .pers13 ~~                                                             
   .pers16           -0.081    0.038   -2.112    0.035   -0.081   -0.099
   .pers26           -0.019    0.044   -0.438    0.661   -0.019   -0.020
 .pers03 ~~                                                             
   .pers36           -0.072    0.042   -1.727    0.084   -0.072   -0.074

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .pers03            0.708    0.105    6.728    0.000    0.708    0.735
   .pers07            0.536    0.149    3.597    0.000    0.536    0.556
   .pers11            1.390    0.094   14.787    0.000    1.390    0.995
   .pers13            0.687    0.152    4.525    0.000    0.687    0.624
   .pers16            0.966    0.067   14.335    0.000    0.966    0.964
   .pers26            1.350    0.091   14.778    0.000    1.350    0.996
   .pers36            1.309    0.091   14.381    0.000    1.309    0.959
    f1                0.255    0.103    2.481    0.013    1.000    1.000</code></pre>
</div>
</div>
<p>With the above information we can claim that these items are measuring a latent factor that Iâ€™ve decided to name <code>active worker</code>. It is worth mentioning that some of the items are measuring the same aspect of this latent variable, that is why some correlated errors are introduced in the model.</p>
</section>
</section>
<section id="question-2" class="level1">
<h1>Question 2</h1>
<section id="a-1" class="level2">
<h2 class="anchored" data-anchor-id="a-1">a)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">=</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(cor_mat, <span class="at">n =</span> <span class="fu">nrow</span>(data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$chisq
[1] 6730.363

$p.value
[1] 0

$df
[1] 946</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Kaiser-Meyer-Olkin factor adequacy
Call: KMO(r = drop_na(data))
Overall MSA =  0.84
MSA for each item = 
pers01 pers02 pers03 pers04 pers05 pers06 pers07 pers08 pers09 pers10 pers11 
  0.83   0.76   0.91   0.87   0.85   0.85   0.89   0.90   0.79   0.80   0.79 
pers12 pers13 pers14 pers15 pers16 pers17 pers18 pers19 pers20 pers21 pers22 
  0.76   0.87   0.87   0.76   0.85   0.84   0.83   0.81   0.82   0.86   0.87 
pers23 pers24 pers25 pers26 pers27 pers28 pers29 pers30 pers31 pers32 pers33 
  0.90   0.87   0.75   0.84   0.84   0.90   0.79   0.68   0.84   0.85   0.80 
pers34 pers35 pers36 pers37 pers38 pers39 pers40 pers41 pers42 pers43 pers44 
  0.79   0.71   0.89   0.84   0.88   0.88   0.79   0.74   0.88   0.89   0.66 </code></pre>
</div>
</div>
<p>Given the results of this two test, we can conclude that the data is suitable for factor analysis. First, the Bartlettâ€™s test of sphericity provides evidence that our correlation matrix is different from the identity matrix and that there is an intercorrelation between variables that can be explained by common factors. Then, the KMO provides evidence that our data suitable for this analysis, with an overall measure of sampling adequacy of <span class="math inline">\(0.84\)</span>, which is great</p>
</section>
<section id="b-1" class="level2">
<h2 class="anchored" data-anchor-id="b-1">b)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(data, <span class="at">fm =</span> <span class="st">"ml"</span>, <span class="at">n.obs =</span> <span class="fu">nrow</span>(data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  6  and the number of components =  6 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Both the parallel analysis and the scree-plot suggest that the number of factors to be extracted is <span class="math inline">\(6\)</span>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>efa_01 <span class="ot">=</span> <span class="fu">fa</span>(cor_mat, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">nfactors =</span> <span class="dv">6</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">n.obs =</span> <span class="fu">nrow</span>(data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()), </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">fm =</span> <span class="st">"ml"</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">rotate =</span> <span class="st">"none"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(efa_01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Factor analysis with Call: fa(r = cor_mat, nfactors = 6, n.obs = nrow(drop_na(data)), rotate = "none", 
    fm = "ml")

Test of the hypothesis that 6 factors are sufficient.
The degrees of freedom for the model is 697  and the objective function was  3.26 
The number of observations was  433  with Chi Square =  1344.09  with prob &lt;  1.7e-43 

The root mean square of the residuals (RMSA) is  0.04 
The df corrected root mean square of the residuals is  0.04 

Tucker Lewis Index of factoring reliability =  0.846
RMSEA index =  0.046  and the 10 % confidence intervals are  0.043 0.05
BIC =  -2887.21</code></pre>
</div>
</div>
<p>Based on the goodness-of-fit indices, this model seems to be doing a decent job in explaining the intercorrelation between the items. Even thought the <span class="math inline">\(\chi^2\)</span> test is significant, the other measures to evaluate how good the data fits the model are withing acceptable ranges.</p>
</section>
<section id="c-1" class="level2">
<h2 class="anchored" data-anchor-id="c-1">c)</h2>
<p>Because these items are similar, I would prefer an oblique rotation to allow correlation between the latent factors.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>efa_02 <span class="ot">=</span> <span class="fu">fa</span>(cor_mat, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">nfactors =</span> <span class="dv">6</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">n.obs =</span> <span class="fu">nrow</span>(data <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()), </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">fm=</span><span class="st">"ml"</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">rotate =</span> <span class="st">"promax"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>efa_02<span class="sc">$</span>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
       ML2    ML1    ML3    ML5    ML4    ML6   
pers01        -0.663  0.210  0.333 -0.106  0.313
pers02  0.187 -0.129  0.193 -0.451         0.364
pers03  0.664                0.122         0.129
pers04         0.122  0.512 -0.147        -0.120
pers05  0.120 -0.199                0.535       
pers06  0.128  0.728                0.119       
pers07  0.190                0.502              
pers08 -0.620                              0.165
pers09         0.166 -0.716                0.162
pers10                              0.362  0.275
pers11               -0.267                0.485
pers12                      -0.321         0.196
pers13  0.528         0.104  0.253              
pers14                0.676                     
pers15  0.118  0.138        -0.140  0.530       
pers16        -0.225         0.130  0.139  0.528
pers17 -0.138        -0.107  0.405         0.139
pers18 -0.725                0.149              
pers19                0.631  0.126  0.130 -0.145
pers20        -0.114  0.156         0.471  0.178
pers21         0.892                0.108 -0.162
pers22                       0.671              
pers23 -0.616               -0.123              
pers24               -0.626                0.201
pers25                      -0.135  0.515  0.201
pers26  0.131 -0.319 -0.181 -0.204         0.512
pers27         0.269        -0.316         0.166
pers28  0.597                0.161              
pers29                0.452                0.127
pers30         0.150                0.530       
pers31         0.700         0.188        -0.117
pers32  0.156                0.664              
pers33  0.655  0.133               -0.108  0.249
pers34         0.143 -0.638                0.207
pers35         0.224               -0.205       
pers36        -0.512         0.225 -0.101  0.427
pers37 -0.228 -0.107        -0.400         0.234
pers38  0.500                              0.195
pers39         0.384  0.437  0.135              
pers40         0.139                0.621       
pers41                             -0.387  0.105
pers42  0.120         0.103  0.595              
pers43 -0.525         0.164                0.236
pers44         0.118                0.491       

                 ML2   ML1   ML3   ML5   ML4   ML6
SS loadings    3.636 3.222 3.193 2.780 2.441 1.936
Proportion Var 0.083 0.073 0.073 0.063 0.055 0.044
Cumulative Var 0.083 0.156 0.228 0.292 0.347 0.391</code></pre>
</div>
</div>
<p>We see some of the largest factor loading to be negative. I attribute this to the nature of the items in this test. Given that these items are trying to measure personality traits, it is tenable to have items with negative loads on some of the traits and still have a meaningful interpretation. Take, for example, item 8 <code>careless</code>. A negative load of this item on some of the latent variable would indicate that the person is not careless, which means that this worker is careful. In other words, these items may be in reverse coding.</p>
<p>With the loading of the rotated solution, I can provide the following interpretation of the latent factors:</p>
<ul>
<li>Factor 1 (Calmn): This factor might capture emotional stability and calmness, with items like â€œemotionally stable,â€ â€œcalm in tense situations,â€ and â€œrelaxedâ€ showing high loadings.</li>
<li>Factor 2 (Reliable): Indicated by high loadings on items like â€œdoes a thorough job,â€ â€œreliable,â€ and â€œperseveres,â€ this factor likely measures conscientiousness, work ethic, and reliability.</li>
<li>Factor 3 (Worry): This factor might capture worry, with items like â€œdepressed,â€ â€œnot relaxed,â€ and â€œworriesâ€ showing high loadings.</li>
<li>Factor 4 (Creative): Suggested by high loadings on â€œoriginal,â€ â€œimaginative,â€ and â€œvalues artistic experiences,â€ this factor seems to represent openness to experience and creativity.</li>
<li>Factor 5 (Trustworthy): Indicated by high loadings on items like â€œtrusting,â€ â€œconsiderate,â€ and â€œco-operative,â€ this factor likely measures to what extent the worker is trustworthy.</li>
<li>Factor 6 (Leadership): This factor might be related to assertiveness and leadership qualities, as indicated by items like â€œassertive,â€ â€œgenerates enthusiasm in others,â€ and â€œsophisticated in art &amp; musicâ€ having high loadings.</li>
</ul>
</section>
<section id="d-1" class="level2">
<h2 class="anchored" data-anchor-id="d-1">d)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>efa_02<span class="sc">$</span>communalities <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">item =</span> <span class="fu">parse_number</span>(names),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">communality =</span> x,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.keep =</span> <span class="st">"unused"</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> item, <span class="at">y =</span> communality)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"tomato4"</span>) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot-com" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-plot-com-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Communalities</figcaption>
</figure>
</div>
</div>
</div>
<p>Low communalities in a factor analysis, like the ones observed in <a href="#fig-plot-com">Figure&nbsp;1</a> (specifically, pers10, pers12, pers17, pers35), suggest that these items are not well explained by the underlined extracted factors. In this context, this can mean that these specific items do not align well with the underlying constructs we are trying to measure with this instrument. In other words, these items might be measuring aspects of personality that are not captured by the six factors weâ€™ve identified, or they may be less relevant or inconsistent in the context of the other items and factors in this questionnaire.</p>
</section>
<section id="e-1" class="level2">
<h2 class="anchored" data-anchor-id="e-1">e)</h2>
<p>Factor Analysis (FA) is more appropriate for this dataset than Principal Component Analysis (PCA) because FA seeks to identify latent variables that explain observed variables, which is suitable for psychological and personality data, like the one we have. FA models the underlying structure that explains correlations between items, focusing on shared variance. In contrast, PCA maximizes total variance, treating all variance as equally important. PCA would provide a different perspective by combining items into components based on total variance, potentially mixing measurement and error variances, which might not be as meaningful for understanding underlying personality constructs.</p>
</section>
<section id="f" class="level2">
<h2 class="anchored" data-anchor-id="f">f)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  skimr<span class="sc">::</span><span class="fu">skim</span>() <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(skim_variable, numeric.sd) <span class="sc">|&gt;</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="eooisagoqd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eooisagoqd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eooisagoqd thead, #eooisagoqd tbody, #eooisagoqd tfoot, #eooisagoqd tr, #eooisagoqd td, #eooisagoqd th {
  border-style: none;
}

#eooisagoqd p {
  margin: 0;
  padding: 0;
}

#eooisagoqd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eooisagoqd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eooisagoqd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eooisagoqd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eooisagoqd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eooisagoqd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eooisagoqd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eooisagoqd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eooisagoqd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eooisagoqd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eooisagoqd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eooisagoqd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eooisagoqd .gt_spanner_row {
  border-bottom-style: hidden;
}

#eooisagoqd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eooisagoqd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eooisagoqd .gt_from_md > :first-child {
  margin-top: 0;
}

#eooisagoqd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eooisagoqd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eooisagoqd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eooisagoqd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eooisagoqd .gt_row_group_first td {
  border-top-width: 2px;
}

#eooisagoqd .gt_row_group_first th {
  border-top-width: 2px;
}

#eooisagoqd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eooisagoqd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eooisagoqd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eooisagoqd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eooisagoqd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eooisagoqd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eooisagoqd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eooisagoqd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eooisagoqd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eooisagoqd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eooisagoqd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eooisagoqd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eooisagoqd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eooisagoqd .gt_left {
  text-align: left;
}

#eooisagoqd .gt_center {
  text-align: center;
}

#eooisagoqd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eooisagoqd .gt_font_normal {
  font-weight: normal;
}

#eooisagoqd .gt_font_bold {
  font-weight: bold;
}

#eooisagoqd .gt_font_italic {
  font-style: italic;
}

#eooisagoqd .gt_super {
  font-size: 65%;
}

#eooisagoqd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eooisagoqd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eooisagoqd .gt_indent_1 {
  text-indent: 5px;
}

#eooisagoqd .gt_indent_2 {
  text-indent: 10px;
}

#eooisagoqd .gt_indent_3 {
  text-indent: 15px;
}

#eooisagoqd .gt_indent_4 {
  text-indent: 20px;
}

#eooisagoqd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="skim_variable">skim_variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="numeric.sd">numeric.sd</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="skim_variable" class="gt_row gt_left">pers23</td>
<td headers="numeric.sd" class="gt_row gt_right">1.3331569</td></tr>
    <tr><td headers="skim_variable" class="gt_row gt_left">pers40</td>
<td headers="numeric.sd" class="gt_row gt_right">0.9584261</td></tr>
    <tr><td headers="skim_variable" class="gt_row gt_left">pers16</td>
<td headers="numeric.sd" class="gt_row gt_right">1.0024508</td></tr>
    <tr><td headers="skim_variable" class="gt_row gt_left">pers09</td>
<td headers="numeric.sd" class="gt_row gt_right">1.2724000</td></tr>
    <tr><td headers="skim_variable" class="gt_row gt_left">pers39</td>
<td headers="numeric.sd" class="gt_row gt_right">1.2800991</td></tr>
    <tr><td headers="skim_variable" class="gt_row gt_left">pers07</td>
<td headers="numeric.sd" class="gt_row gt_right">0.9865824</td></tr>
    <tr><td headers="skim_variable" class="gt_row gt_left">pers17</td>
<td headers="numeric.sd" class="gt_row gt_right">1.0737346</td></tr>
    <tr><td headers="skim_variable" class="gt_row gt_left">pers15</td>
<td headers="numeric.sd" class="gt_row gt_right">1.1121947</td></tr>
    <tr><td headers="skim_variable" class="gt_row gt_left">pers41</td>
<td headers="numeric.sd" class="gt_row gt_right">1.2284147</td></tr>
    <tr><td headers="skim_variable" class="gt_row gt_left">pers34</td>
<td headers="numeric.sd" class="gt_row gt_right">1.1216669</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Performing an exploratory factor analysis using the covariance matrix is reasonable for this dataset, as the items (pers01 to pers44) are on the same 5-point scale and have similar standard deviations (and hence variances). This similarity in scaling and variance allows for a meaningful comparison of the covariance among items. The results of the factor analysis using the covariance matrix would focus more directly on the shared variances in their original scale, potentially providing insights that align more closely with the actual variance observed in the data. In conclusion, the result will be very similar.</p>
</section>
</section>
<section id="question-3" class="level1">
<h1>Question 3</h1>
<section id="a-2" class="level2">
<h2 class="anchored" data-anchor-id="a-2">a)</h2>
<p>By definition of our model, we have the following:</p>
<p><span class="math display">\[
\hat{\Sigma} = \hat{\Lambda}\hat{\Lambda}^{t} + \hat{\Psi}
\]</span></p>
<p>Using linear algebra, we can compute the fitted correlation matrix as follows:</p>
<p><span class="math display">\[
\begin{align*}
\hat{\Sigma} &amp;= \begin{bmatrix}
0.4 &amp; 0.8\\
0.7 &amp; -0.4\\
0.1 &amp; 0.7\\
0.5 &amp; -0.7\\
0.5 &amp; -0.3\\
0.5 &amp; 0.2
\end{bmatrix} \cdot \begin{bmatrix}
0.4 &amp; 0.8\\
0.7 &amp; -0.4\\
0.1 &amp; 0.7\\
0.5 &amp; -0.7\\
0.5 &amp; -0.3\\
0.5 &amp; 0.2
\end{bmatrix}^t + \begin{bmatrix}
.20 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; .35 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; .50 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; .26 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; .66 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; .80
\end{bmatrix} \\
\\
&amp;= \begin{bmatrix}
(0.4 \times 0.4 + 0.8 \times 0.8) &amp; (0.4 \times 0.7 + 0.8 \times -0.4) &amp; \cdots &amp; (0.4 \times 0.5 + 0.8 \times 0.2) \\
(0.7 \times 0.4 + -0.4 \times 0.8) &amp; (0.7 \times 0.7 + -0.4 \times -0.4) &amp; \cdots &amp; (0.7 \times 0.5 + -0.4 \times 0.2) \\
\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\\
(0.5 \times 0.4 + 0.2 \times 0.8) &amp; (0.5 \times 0.7 + 0.2 \times -0.4) &amp; \cdots &amp; (0.5 \times 0.5 + 0.2 \times 0.2) \\
\end{bmatrix}\\ &amp;+ \begin{bmatrix}
.20 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; .35 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; .50 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; .26 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; .66 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; .80
\end{bmatrix} \\
\\
&amp;= \begin{bmatrix}
0.80 &amp; -0.04 &amp; 0.60 &amp; -0.36 &amp; -0.04 &amp; 0.32 \\
-0.04 &amp; 0.65 &amp; -0.07 &amp; 0.49 &amp; 0.53 &amp; 0.38 \\
0.60 &amp; -0.07 &amp; 0.50 &amp; -0.44 &amp; -0.16 &amp; 0.18 \\
-0.36 &amp; 0.49 &amp; -0.44 &amp; 0.74 &amp; 0.66 &amp; 0.14 \\
-0.04 &amp; 0.53 &amp; -0.16 &amp; 0.66 &amp; 0.34 &amp; 0.26 \\
0.32 &amp; 0.38 &amp; 0.18 &amp; 0.14 &amp; 0.26 &amp; 0.29 \\
\end{bmatrix} + \begin{bmatrix}
.20 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; .35 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; .50 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; .26 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; .66 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; .80
\end{bmatrix} \\
\\
&amp;= \begin{bmatrix}
1.00 &amp; -0.04 &amp; 0.60 &amp; -0.36 &amp; -0.04 &amp; 0.32 \\
-0.04 &amp; 1.00 &amp; -0.21 &amp; 0.63 &amp; 0.47 &amp; 0.20 \\
0.60 &amp; -0.21 &amp; 1.00 &amp; -0.44 &amp; -0.16 &amp; 0.18 \\
-0.36 &amp; 0.63 &amp; -0.44 &amp; 1.00 &amp; 0.46 &amp; 0.06 \\
-0.04 &amp; 0.47 &amp; -0.16 &amp; 0.46 &amp; 1.00 &amp; 0.14 \\
0.32 &amp; 0.20 &amp; 0.18 &amp; 0.06 &amp; 0.14 &amp; 1.00 \\
\end{bmatrix}
\end{align*}
\]</span></p>
</section>
<section id="b-2" class="level2">
<h2 class="anchored" data-anchor-id="b-2">b)</h2>
<p>For each item, the communality can be computed as follows:</p>
<ul>
<li>Variable 1: <span class="math inline">\((0.4)^2 + (0.8)^2 = 0.80\)</span></li>
<li>Variable 2: <span class="math inline">\((0.7)^2 + (-0.4)^2 = 0.65\)</span></li>
<li>Variable 3: <span class="math inline">\((0.1)^2 + (0.7)^2 = 0.50\)</span></li>
<li>Variable 4: <span class="math inline">\((0.5)^2 + (-0.7)^2 = 0.74\)</span></li>
<li>Variable 5: <span class="math inline">\((0.5)^2 + (-0.3)^2 = 0.34\)</span></li>
<li>Variable 6: <span class="math inline">\((0.4)^2 + (-0.2)^2 = 0.20\)</span></li>
</ul>
<p>The uniqueness can be computed as the complement of the communality, this because the correlation matrix was used to perform the factor analysis:</p>
<ul>
<li>Variable 1: <span class="math inline">\(1 - 0.80 = 0.20\)</span></li>
<li>Variable 2: <span class="math inline">\(1 - 0.65 = 0.35\)</span></li>
<li>Variable 3: <span class="math inline">\(1 - 0.50 = 0.50\)</span></li>
<li>Variable 4: <span class="math inline">\(1 - 0.74 = 0.26\)</span></li>
<li>Variable 5: <span class="math inline">\(1 - 0.34 = 0.66\)</span></li>
<li>Variable 6: <span class="math inline">\(1 - 0.20 = 0.80\)</span></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Pablo Vivas</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>